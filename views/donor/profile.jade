extend ../layout

block extraHeader
  link(href='/stylesheets/navbar-loggedin.css', rel='stylesheet')
  link(href='/stylesheets/donor/profile.css', rel='stylesheet')
  

block content
  script.
    window.fbAsyncInit = function() {
      FB.init({
          appId	: '506830149486287',
          xfbml	: true,
          status : true,
          cookie : true,
          version: 'v2.5'
      });
    };

    (function(d, s, id){
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) {return;}
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/en_US/sdk.js";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));
  script.
    var bodyEl = document.getElementsByTagName('body');
    var user = !{JSON.stringify(user)};
    var documents = !{JSON.stringify(documents)};
    var applications = !{JSON.stringify(applications)}
    var donations = !{JSON.stringify(donations)};
    var updates = !{JSON.stringify(updates)};
    var loggedInUser = !{JSON.stringify(loggedInUser)};
    if(loggedInUser){
      bodyEl[0].className = bodyEl[0].className.split('nojs').join(' jsEnabled ');
      windowPortWidth = window.innerWidth;
      if(windowPortWidth <767){
        document.write('<style type="text/css">nav.navbar-custom{display:none}</style>');
      }
    }
  include ../navbar.jade
  include ../partials/navbar-loggedin.jade
  include ../advanced-search.jade
  include ../partials/signup-modal.jade
  
  .container
    .heading.main-info
      .profile_picture
        if user.profile_picture
          img
        else 
          .initials.circle= user.initials
      .info-div
        .name= user.username
        if user.date_of_birth
          .dob= user.date_of_birth
        else
          a(href='/donor/settings')
            .dob.add Add your date of birth
        if user.country_of_residence
          .country= user.country_of_residence
        else
          a(href='/donor/settings')
            .country.add Add your country of resience
    .main-content
      #bio
        .header
          h1 Your Bio
        if donor.bio
          p.bio= donor.bio
        else 
          p.bio.else You haven't added a bio yet. 
            a(href='/donor/settings') Update your profile now
      #updates
        .header
          h1 Updates
          p.updates You don't have any updates at the moment.
      #donations
        .header
          h1 Your Donations
          .donation-container
            if charges
              each user in charges
                .flex_box
                  .image(class=user.number)
                    if(user.profile_picture)
                      img(src=user.profile_picture)
                    else
                      .initials.circle(class=user.number)= user.initials
                  .information
                    .basic-info
                      span Â£#{user.amount}
                      a(href='/public/' + '#{user.id}')
                        p= user.username
                      span= user.chargeDate
            else
              p.donations.else You haven't made any donations yet.
                a(href='/results/users') Search for students now!
          
        

block scripts
  //moment
  script(src='/bower_components/moment/min/moment-with-locales.js')
  script(src='/javascript/advanced-search.js')
  script(src='/javascript/notifications.js')
  script(src='/javascript/signup-login.js')
  script(src='/javascript/user-crowdfunding.js')
  script(src='/javascript/donor/profile.js')
  script.
    var user = !{JSON.stringify(user)}
    console.log(user)
